{"files":[{"id":"7d71e58e-4757-47a6-a0d3-5c9e1caafd84","name":"Code","type":"server_js","source":"function myFunction() {\n  //var template \u003d DriveApp.getFilesByName(\u0027DataDashboardTemplate\u0027).next();\n  var date \u003d new Date();\n  var mondayDate \u003d new Date();\n  date.setDate(date.getDate()+1);\n  var tuesdayDate \u003d new Date(date);\n  date.setDate(date.getDate()+1);\n  var wednesdayDate \u003d new Date(date);\n  date.setDate(date.getDate()+1);\n  var thursdayDate \u003d new Date(date);\n  date.setDate(date.getDate()+1);\n  var fridayDate \u003d new Date (date);\n  var ddFileName \u003d \"Data Dashboard for week of \"+fileNameDateString(mondayDate)\n  var dd \u003d SpreadsheetApp.open(DriveApp.getFilesByName(ddFileName).next());\n  //var dd \u003d template.makeCopy(ddFileName);\n  //dd \u003d SpreadsheetApp.open(dd);\n  var ddDays \u003d dd.getSheetByName(\u0027Days\u0027);\n  ddDays.getRange(\"B2:F2\").setValues([[powerSchoolDateString(mondayDate),powerSchoolDateString(tuesdayDate),powerSchoolDateString(wednesdayDate),powerSchoolDateString(thursdayDate),powerSchoolDateString(fridayDate)]]);\n  var studentAttendance \u003d dd.getSheetByName(\u0027Student Attendance\u0027);\n  var rawStudentData \u003d DriveApp.getFilesByName(\u0027activeStudents.csv\u0027).next().getBlob().getDataAsString();\n  var studentCSV \u003d Utilities.parseCsv(rawStudentData);\n  studentAttendance.getRange(1,1,studentCSV.length,studentCSV[0].length).setValues(studentCSV);\n  \n  \n  \n  \n  \n\n   \n}\n\nfunction fileNameDateString(date){\n  const months \u003d [\u0027January\u0027,\u0027February\u0027,\u0027March\u0027,\u0027April\u0027,\u0027May\u0027,\u0027June\u0027,\u0027July\u0027,\u0027August\u0027,\u0027September\u0027,\u0027October\u0027,\u0027November\u0027,\u0027December\u0027]\n  var day \u003d \"0\"+date.getDate();\n  var month \u003d months[date.getMonth()];\n  var year \u003d date.getFullYear();\n  day\u003dday.substr(day.length-2,2)\n  var string \u003d month+\" \"+day+\" \"+year\n  return string\n}\n\nfunction powerSchoolDateString(date){\n  const months \u003d [\u0027January\u0027,\u0027February\u0027,\u0027March\u0027,\u0027April\u0027,\u0027May\u0027,\u0027June\u0027,\u0027July\u0027,\u0027August\u0027,\u0027September\u0027,\u0027October\u0027,\u0027November\u0027,\u0027December\u0027]\n  var day \u003d \"0\"+date.getDate();\n  var month \u003d months[date.getMonth()].substr(0,3);\n  var year \u003d date.getYear();\n  day\u003dday.substr(day.length-2,2)\n  var string \u003d day+\"-\"+month+\"-\"+year\n  return string\n}"},{"id":"ccbcaf7e-22a4-4323-bc94-bb80df917013","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/New_York\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\"\n}"}]}