{"files":[{"id":"0b4409d9-33f5-4029-88e8-096436817e88","name":"Code","type":"server_js","source":"function myFunction() {\n  var dataDashboard \u003d SpreadsheetApp.openByUrl(\u0027https://docs.google.com/spreadsheets/d/1N8hgrJdAhNdqjxw53cJDXENhAxSMvxwKG-IefwHltXQ/edit#gid\u003d382600555\u0027);\n  var grades \u003d dataDashboard.getSheetByName(\u0027Grades\u0027)\n  var attendance \u003d dataDashboard.getSheetByName(\u0027AttendanceData\u0027)\n\n  \n  var url \u003d \u0027https://cristoreyrichmond.powerschool.com/ws/schema/query/com.cristoreyrichmond.data.dashboard.grades?pagesize\u003d0\u0027\n  var options \u003d {\n    \u0027method\u0027 : \u0027post\u0027,\n    \u0027headers\u0027: {\n    \u0027Authorization\u0027: \u0027Bearer 45c1d9e2-e99f-4c77-97e5-6fbc1f57a452\u0027,\n    \u0027Content-Type\u0027: \u0027application/json\u0027\n  }\n  }\n  var response \u003d UrlFetchApp.fetch(url,options)\n  var data \u003d JSON.parse(response)\n  var gradeMatrix \u003d [];\n  gradeMatrix[0] \u003d [\u0027studentId\u0027,\u0027course\u0027,\u0027term\u0027,\u0027percent\u0027]\n  var i \u003d1;\n  data.record.forEach(entry \u003d\u003e{\n  gradeMatrix[i] \u003d [];\n  gradeMatrix[i][0] \u003d entry.student_name;\n  gradeMatrix[i][1] \u003d entry.course_name;\n  gradeMatrix[i][2] \u003d entry.term;\n  gradeMatrix[i][3] \u003d entry.percent;\n  i++;\n  \n  })\n  Logger.log(gradeMatrix.length)\n  grades.clear()\n  grades.getRange(1,1,gradeMatrix.length,gradeMatrix[0].length).setValues(gradeMatrix)\n  \n  \n  \n  \n  \n    \n  url \u003d \u0027https://cristoreyrichmond.powerschool.com/ws/schema/query/com.cristoreyrichmond.data.dashboard.attendance?pagesize\u003d0\u0027\n  options \u003d {\n    \u0027method\u0027 : \u0027post\u0027,\n    \u0027headers\u0027: {\n    \u0027Authorization\u0027: \u0027Bearer 45c1d9e2-e99f-4c77-97e5-6fbc1f57a452\u0027,\n    \u0027Content-Type\u0027: \u0027application/json\u0027\n    }\n  }\n  response \u003d UrlFetchApp.fetch(url,options)\n  data \u003d JSON.parse(response)\n  var attendanceMatrix \u003d [];\n  attendanceMatrix[0] \u003d [\u0027studentId\u0027,\u0027date\u0027,\u0027mode\u0027,\u0027code\u0027]\n  i \u003d1;\n  data.record.forEach(entry \u003d\u003e{\n  attendanceMatrix[i] \u003d [];\n  attendanceMatrix[i][0] \u003d entry.studentid;\n  attendanceMatrix[i][1] \u003d entry.date;\n  attendanceMatrix[i][2] \u003d entry.mode;\n  attendanceMatrix[i][3] \u003d entry.code;\n  i++;\n  \n  })\n  Logger.log(gradeMatrix.length)\n  attendance.clear()\n  attendance.getRange(1,1,attendanceMatrix.length,attendanceMatrix[0].length).setValues(attendanceMatrix)\n  \n\n}\n"},{"id":"2862e11b-48fa-4580-a96c-4179ee648eb5","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/New_York\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"}]}