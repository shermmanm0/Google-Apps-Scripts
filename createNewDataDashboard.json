{"files":[{"id":"c09f6c2c-5930-441d-aaab-8716fdc751d0","name":"Code","type":"server_js","source":"function myFunction() {\n  var template \u003d DriveApp.getFilesByName(\u0027DataDashboardTemplate\u0027).next();\n  var date \u003d new Date();\n  var mondayDate \u003d new Date();\n  date.setDate(date.getDate()+1);\n  var tuesdayDate \u003d new Date(date);\n  date.setDate(date.getDate()+1);\n  var wednesdayDate \u003d new Date(date);\n  date.setDate(date.getDate()+1);\n  var thursdayDate \u003d new Date(date);\n  date.setDate(date.getDate()+1);\n  var fridayDate \u003d new Date (date);\n  var ddFileName \u003d \"Data Dashboard for week of \"+fileNameDateString(mondayDate)\n  //var dd \u003d SpreadsheetApp.open(DriveApp.getFilesByName(ddFileName).next());\n  var dd \u003d template.makeCopy(ddFileName);\n  dd \u003d SpreadsheetApp.open(dd);\n  var ddDays \u003d dd.getSheetByName(\u0027Days\u0027);\n  var calDays \u003d [[powerSchoolDateString(mondayDate),powerSchoolDateString(tuesdayDate),powerSchoolDateString(wednesdayDate),powerSchoolDateString(thursdayDate),powerSchoolDateString(fridayDate)]];\n  ddDays.getRange(\"B2:F2\").setValues(calDays);\n  var studentAttendance \u003d dd.getSheetByName(\u0027Student Attendance\u0027);\n  var rawStudentData \u003d DriveApp.getFilesByName(\u0027activeStudents.csv\u0027).next().getBlob().getDataAsString();\n  var studentCSV \u003d Utilities.parseCsv(rawStudentData);\n  studentAttendance.getRange(1,1,studentCSV.length,studentCSV[0].length).setValues(studentCSV);\n  var dailyAttendanceSheet \u003d dd.getSheetByName(\u0027Daily Attendance\u0027);\n  var dailyAttendanceCSV \u003d Utilities.parseCsv(DriveApp.getFilesByName(\u0027weeklyDailyAttendance.csv\u0027).next().getBlob().getDataAsString());\n  dailyAttendanceSheet.getRange(\"G1:K1\").setValues(calDays);\n  dailyAttendanceSheet.getRange(1,1,dailyAttendanceCSV.length,dailyAttendanceCSV[0].length).setValues(dailyAttendanceCSV);\n  var periodAttendanceSheet \u003d dd.getSheetByName(\u0027Period Attendance\u0027);\n  var periodAttendanceCSV \u003d Utilities.parseCsv(DriveApp.getFilesByName(\u0027weeklyPeriodAttendance.csv\u0027).next().getBlob().getDataAsString());\n  periodAttendanceSheet.getRange(\"F1:J1\").setValues(calDays);\n  periodAttendanceSheet.getRange(1,1,periodAttendanceCSV.length,periodAttendanceCSV[0].length).setValues(periodAttendanceCSV);\n  var dailyAttendanceCountsSheets \u003d dd.getSheetByName(\u0027Daily Attendance Counts\u0027);\n  var dailyAttendanceCountsCSV \u003d Utilities.parseCsv(DriveApp.getFilesByName(\u0027dailyAttendanceCounts.csv\u0027).next().getBlob().getDataAsString());\n  dailyAttendanceCountsSheets.getRange(1,1,dailyAttendanceCountsCSV.length,dailyAttendanceCountsCSV[0].length).setValues(dailyAttendanceCountsCSV);\n  var meetingAttendanceCountsSheets \u003d dd.getSheetByName(\u0027Meeting Attendance Counts\u0027);\n  var meetingAttendanceCountsCSV \u003d Utilities.parseCsv(DriveApp.getFilesByName(\u0027meetingAttendanceCounts.csv\u0027).next().getBlob().getDataAsString());\n  meetingAttendanceCountsSheets.getRange(1,1,meetingAttendanceCountsCSV.length,meetingAttendanceCountsCSV[0].length).setValues(meetingAttendanceCountsCSV);\n  var teachersSheets \u003d dd.getSheetByName(\u0027Teacher Data\u0027);\n  var teachersCSV \u003d Utilities.parseCsv(DriveApp.getFilesByName(\u0027teachers.csv\u0027).next().getBlob().getDataAsString());\n  teachersSheets.getRange(1,1,teachersCSV.length,teachersCSV[0].length).setValues(teachersCSV);\n  var gradeBookUpdateSheets \u003d dd.getSheetByName(\u0027Gradebook Updates\u0027)\n  var gradeBookUpdateCSV \u003d Utilities.parseCsv(DriveApp.getFilesByName(\u0027gradebookUpdates.csv\u0027).next().getBlob().getDataAsString());\n  gradeBookUpdateSheets.getRange(1,1,gradeBookUpdateCSV.length,gradeBookUpdateCSV[0].length).setValues(gradeBookUpdateCSV);\n  var termGradesSheets \u003d dd.getSheetByName(\u0027Term Grades\u0027)\n  var termGradesCSV \u003d Utilities.parseCsv(DriveApp.getFilesByName(\u0027termGradesByPeriod.csv\u0027).next().getBlob().getDataAsString());\n  termGradesSheets.getRange(1,1,termGradesCSV.length,termGradesCSV[0].length).setValues(termGradesCSV);\n  var yearGradesSheets \u003d dd.getSheetByName(\u0027Year Grades\u0027)\n  var yearGradesCSV \u003d Utilities.parseCsv(DriveApp.getFilesByName(\u0027yearGradesByPeriod.csv\u0027).next().getBlob().getDataAsString());\n  yearGradesSheets.getRange(1,1,yearGradesCSV.length,yearGradesCSV[0].length).setValues(yearGradesCSV);\n\n  \n  \n}\n\nfunction fileNameDateString(date){\n  const months \u003d [\u0027January\u0027,\u0027February\u0027,\u0027March\u0027,\u0027April\u0027,\u0027May\u0027,\u0027June\u0027,\u0027July\u0027,\u0027August\u0027,\u0027September\u0027,\u0027October\u0027,\u0027November\u0027,\u0027December\u0027]\n  var day \u003d \"0\"+date.getDate();\n  var month \u003d months[date.getMonth()];\n  var year \u003d date.getFullYear();\n  day\u003dday.substr(day.length-2,2)\n  var string \u003d month+\" \"+day+\" \"+year\n  return string\n}\n\nfunction powerSchoolDateString(date){\n  const months \u003d [\u0027January\u0027,\u0027February\u0027,\u0027March\u0027,\u0027April\u0027,\u0027May\u0027,\u0027June\u0027,\u0027July\u0027,\u0027August\u0027,\u0027September\u0027,\u0027October\u0027,\u0027November\u0027,\u0027December\u0027]\n  var day \u003d \"0\"+date.getDate();\n  var month \u003d months[date.getMonth()].substr(0,3);\n  var year \u003d date.getYear();\n  day\u003dday.substr(day.length-2,2)\n  var string \u003d day+\"-\"+month+\"-\"+year\n  return string\n}\n\nfunction updateSheet(){\n\n\n\n\n}"},{"id":"1c2762c4-c5e9-40ea-b19d-799874699a4a","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/New_York\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\"\n}"}]}